<% if @company.reservations.empty? %>
  <h5 style="text-align: center;">
    You don't have any reservations for today !
  </h5>
<% else %>
  <% @company.reservations.group_by { |reservation| reservation.created_at.to_date }.each do |date, reservations| %>
    <h5 style="margin: 20px;">
      <%= date.strftime('%d %B %Y') %>
    </h5>
    <table class="table" style="margin-top: 20px;">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Phone number</th>
          <th scope="col">Start time</th>
          <th scope="col">End time</th>
          <th scope="col">Additional details</th>
        </tr>
      </thead>
      <tbody>
        <% reservations.sort_by { |reservation| reservation.reservation_date }.each_with_index do |reservation, index| %>
          <tr>
            <th scope="row">
              <%= index + 1 %>
            </th>
            <td>
              <%= "**** *** #{reservation.phone_number.chars.last(3).join}" %>
            </td>
            <td>
              <%= reservation.reservation_date.strftime('%H:%M') %>
            </td>
            <td>
              <%= (reservation.reservation_date + @company.unit_of_time.minutes).strftime('%H:%M') %>
            </td>
            <td>
              <%= reservation.details %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  <% end %>
<% end %>
